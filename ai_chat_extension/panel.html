<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Browser Agent</title>
  <link rel="stylesheet" href="panel.css" />
  <link rel="stylesheet" href="panel_welcome.css" />
</head>
<body>
  <div class="container">
    <div class="chat-window" id="messages">
      <!-- Messages will be dynamically added here -->
    </div>
    
    <div class="chat-input-area">
      <div class="input-wrapper">
        <textarea id="prompt" placeholder="Ask anything (Ctrl+L)" rows="1"></textarea>
        <div class="input-overlay-controls">
          <div class="input-controls-left">
            <span id="statusDot" class="status-dot offline" title="Offline"></span>
            <button type="button" id="addDoc" class="input-control-btn" title="Attach document" aria-label="Attach document">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M16.5 6v10a4.5 4.5 0 0 1-9 0V5a3 3 0 0 1 6 0v9a1.5 1.5 0 0 1-3 0V6h-1.5v8a3 3 0 0 0 6 0V5a4.5 4.5 0 0 0-9 0v11a6 6 0 0 0 12 0V6h-1.5z"/></svg>
            </button>
            <button id="openSettings" class="input-control-btn" title="Settings" aria-label="Settings">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M19.14,12.94a7.14,7.14,0,0,0,.05-.94,7.14,7.14,0,0,0-.05-.94l2.11-1.65a.48.48,0,0,0,.12-.61l-2-3.46a.49.49,0,0,0-.58-.22l-2.49,1a7,7,0,0,0-1.63-.94l-.38-2.65A.48.48,0,0,0,13.61,2H10.39a.48.48,0,0,0-.48.41L9.53,5.06a7.21,7.21,0,0,0-1.63.94l-2.49-1a.49.49,0,0,0-.58.22l-2,3.46a.48.48,0,0,0,.12.61L5,11.06a7.14,7.14,0,0,0-.05.94,7.14,7.14,0,0,0-.05.94L2.86,14.59a.48.48,0,0,0-.12.61l2,3.46a.49.49,0,0,0,.58.22l2.49,1a7,7,0,0,0,1.63.94l.38,2.65a.48.48,0,0,0,.48.41h3.22a.48.48,0,0,0,.48-.41l.38-2.65a7.21,7.21,0,0,0,1.63-.94l2.49,1a.49.49,0,0,0,.58-.22l2-3.46a.48.48,0,0,0-.12-.61ZM12,15.5A3.5,3.5,0,1,1,15.5,12,3.5,3.5,0,0,1,12,15.5Z"/></svg>
            </button>
            <button type="button" id="clearChat" class="input-control-btn" title="New chat" aria-label="New chat">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
            </button>
            <span id="status" class="status">Ready</span>
            <input id="docFile" type="file" multiple accept=".pdf,.docx,.txt,image/*" hidden />
          </div>
          <div class="input-controls-right">
            <button type="submit" id="send" class="send-btn" title="Send message">
              <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2L12 20M5 9L12 2L19 9" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </button>
          </div>
        </div>
      </div>
    </div>

    <aside id="settingsDrawer" class="drawer hidden" aria-hidden="true">
      <div class="drawer-header">
        <button id="closeSettings" class="icon-btn" title="Close"><svg viewBox="0 0 24 24"><path fill="currentColor" d="M18.3 5.71L12 12l6.3 6.29-1.41 1.42L10.59 13.41 4.29 19.71 2.88 18.29 9.17 12 2.88 5.71 4.29 4.29 10.59 10.59 16.89 4.29z"/></svg></button>
      </div>
      <div class="drawer-content">
        <div class="form-row">
          <label for="apiKey" class="small muted">API Key</label>
          <div class="input"><input type="password" id="apiKey" placeholder="Enter your API Key" autocomplete="off" /></div>
        </div>
        <div class="form-row">
          <label for="provider" class="small muted">Provider</label>
          <div class="input">
            <select id="provider">
              <option value="auto">Auto</option>
              <option value="openai">OpenAI</option>
              <option value="google">Google</option>
              <option value="ollama">Ollama (local)</option>
            </select>
          </div>
        </div>
        <div class="form-row">
          <label for="model" class="small muted">Model</label>
          <div class="input"><input type="text" id="model" placeholder="e.g. gpt-5-mini or gemini-2.5-flash" /></div>
        </div>
        <div class="form-row">
          <label for="allowedDomains" class="small muted">Allowed Domains</label>
          <div class="input"><textarea id="allowedDomains" rows="3" placeholder="One per line (e.g. *.google.com)"></textarea></div>
        </div>
        <div class="form-row toggles">
          <label class="toggle"><input type="checkbox" id="enableAllSites" /> <span>Enable All Sites (request permissions)</span></label>
          <label class="toggle"><input type="checkbox" id="keepOpen" /> <span>Keep panel open on startup</span></label>
        </div>
        <div class="actions">
          <button id="saveSettings" class="btn primary">Save</button>
          <button id="resetSettings" class="btn ghost">Reset</button>
        </div>
        <div class="note small">Localhost permissions are always granted by default. "Enable All Sites" requests optional <all_urls> access at runtime.</div>
      </div>
    </aside>
  </div>

  <script src="panel.js" defer></script>
</body>
</html>
